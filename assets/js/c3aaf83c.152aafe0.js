"use strict";(self.webpackChunkpackit_dev=self.webpackChunkpackit_dev||[]).push([[4175],{3905:(e,t,r)=>{r.d(t,{Zo:()=>m,kt:()=>g});var a=r(67294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var l=a.createContext({}),s=function(e){var t=a.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},m=function(e){var t=s(e.components);return a.createElement(l.Provider,{value:t},e.children)},u="mdxType",k={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,l=e.parentName,m=p(e,["components","mdxType","originalType","parentName"]),u=s(r),c=n,g=u["".concat(l,".").concat(c)]||u[c]||k[c]||o;return r?a.createElement(g,i(i({ref:t},m),{},{components:r})):a.createElement(g,i({ref:t},m))}));function g(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,i=new Array(o);i[0]=c;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p[u]="string"==typeof e?e:n,i[1]=p;for(var s=2;s<o;s++)i[s]=r[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,r)}c.displayName="MDXCreateElement"},36862:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>k,frontMatter:()=>o,metadata:()=>p,toc:()=>s});var a=r(87462),n=(r(67294),r(3905));const o={title:"RPKG",authors:"flachman"},i=void 0,p={unversionedId:"automation-tools/rpkg",id:"automation-tools/rpkg",title:"RPKG",description:"- base library for fedpkg provides common functionality for dist-git setups",source:"@site/research/automation-tools/rpkg.md",sourceDirName:"automation-tools",slug:"/automation-tools/rpkg",permalink:"/research/automation-tools/rpkg",draft:!1,editUrl:"https://github.com/packit/research/tree/main/research/automation-tools/rpkg.md",tags:[],version:"current",frontMatter:{title:"RPKG",authors:"flachman"},sidebar:"autogenerated",previous:{title:"RPKG-UTIL",permalink:"/research/automation-tools/rpkg-util"},next:{title:"TITO",permalink:"/research/automation-tools/tito"}},l={},s=[{value:"\u2795",id:"",level:2},{value:"\u2796",id:"-1",level:2},{value:"Requirements",id:"requirements",level:2},{value:"RPKG2",id:"rpkg2",level:2}],m={toc:s},u="wrapper";function k(e){let{components:t,...r}=e;return(0,n.kt)(u,(0,a.Z)({},m,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"base library for fedpkg provides common functionality for dist-git setups"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://pagure.io/rpkg"}," \ud83d\udcbb pagure.io/rpkg"),", ",(0,n.kt)("a",{parentName:"li",href:"https://docs.pagure.org/rpkg"}," \ud83d\udcdc documentation")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("img",{parentName:"li",src:"https://img.shields.io/pypi/pyversions/rpkg.svg",alt:"PyPI - Python Version"}),", ",(0,n.kt)("a",{parentName:"li",href:"https://pypi.org/project/rpkg/"},(0,n.kt)("img",{parentName:"a",src:"https://img.shields.io/pypi/v/rpkg.svg",alt:"PyPI"})),", ",(0,n.kt)("a",{parentName:"li",href:"https://src.fedoraproject.org/rpms/rpkg"}," \ud83d\udce6 fedora packages"))),(0,n.kt)("h2",{id:""},"\u2795"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://docs.pagure.org/rpkg/cli.html#"},"CLI deffinition")," for tools build on top of the rpkg"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://docs.pagure.org/rpkg/api.html"},"Python API"),", some examples:",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://docs.pagure.org/rpkg/api.html#cli"},"cli")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://docs.pagure.org/rpkg/api.html#commands"},"commands"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"add_tag(tagname, force=False, message=None, file=None)")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"build(skip_tag=False, scratch=False, background=False, url=None, chain=None, arches=None, sets=False, nvr_check=True, fail_fast=False)")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"container_build_koji(target_override=False, opts={}, kojiconfig=None, kojiprofile=None, build_client=None, koji_task_watcher=None, nowait=False, flatpak=False)")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"copr_build(project, srpm_name, nowait, config_file)")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"import_srpm(srpm)")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"koji_upload(file, path, callback=None)")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"patch(suffix, rediff=False)")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"prep(arch=None, builddir=None, buildrootdir=None)")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"switch_branch(branch, fetch=True)"),", ..."))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://docs.pagure.org/rpkg/api.html#lookaside"},"lookaside cache"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"download(name, filename, hash, outfile, hashtype=None, **kwargs)")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"remote_file_exists(name, filename, hash)")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"upload(name, filepath, hash)"),", ..."))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://docs.pagure.org/rpkg/api.html#sources"},"sources")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://docs.pagure.org/rpkg/api.html#gitignore"},"gitignore"))))),(0,n.kt)("h2",{id:"-1"},"\u2796"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},".")),(0,n.kt)("h2",{id:"requirements"},"Requirements"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"mock: for local mockbuild."),(0,n.kt)("li",{parentName:"ul"},"rpm-build: for local RPM build, which provides the command line rpm."),(0,n.kt)("li",{parentName:"ul"},"rpmlint: check SPEC."),(0,n.kt)("li",{parentName:"ul"},"copr-cli: for building package in Fedora Copr."),(0,n.kt)("li",{parentName:"ul"},"module-build-service: for building modules.")),(0,n.kt)("h2",{id:"rpkg2"},"RPKG2"),(0,n.kt)("p",null,"rpkg2 is a project forked from rpkg to introduce various major improvements and refactor in order to:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Modern modularization."),(0,n.kt)("li",{parentName:"ul"},"A real library for import from other projects to operate package repository or access package metadata."),(0,n.kt)("li",{parentName:"ul"},"Extensible for writing package client tool."),(0,n.kt)("li",{parentName:"ul"},"A framework to write subcommands in a decoupled way to build artifacts, including RPMs, modules, or containers."),(0,n.kt)("li",{parentName:"ul"},"Remove all deprecation and technical debt."),(0,n.kt)("li",{parentName:"ul"},"Python 3 default apparently.")),(0,n.kt)("p",null,"Examples:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-python"},"from pyrpkg.pkgrepo import PackageRepository\nrepo = PackageRepository('/path/to/package')\nprint(repo.branch_merge)\nprint(repo.branch_remote)\nprint(repo.push_url)\nprint(repo.commit_hash)\n")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-python"},"from pyrpkg.pkgrepo import PackageRepository\nfrom pyrpkg.pkginfo import PackageMetadata\n\nrepo = PackageRepository('/path/to/package')\npkg = PackageMetadata(repo)\nprint(pkg.ns)\nprint(pkg.ns_repo_name)\nprint(pkg.disttag)\nprint(pkg.spec)\n")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-python"},"from pyrpkg.config import read_config\n\nconfig = read_config('/path/to/rpkg.config')\nprint(config.rpkg.anongiturl)\nprint(config.rpkg.distgit_namespaced)\n")),(0,n.kt)("p",null,"Two (probably mirrored) repositories:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://pagure.io/rpkg2"},"https://pagure.io/rpkg2")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://gitlab.com/rpkg/rpkg2"},"https://gitlab.com/rpkg/rpkg2"))),(0,n.kt)("p",null,"And the old github one:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://gitlab.com/rpkg/rpkg2"},"https://gitlab.com/rpkg/rpkg2"))),(0,n.kt)("p",null,"For the background, see ",(0,n.kt)("a",{parentName:"p",href:"https://pagure.io/rpkg/issue/49"},"this discussion")," and the ",(0,n.kt)("a",{parentName:"p",href:"https://fedoraproject.org/wiki/Thoughts_on_rpkg2"},"this wiki ",(0,n.kt)("inlineCode",{parentName:"a"},"Thoughts_on_rpkg2")),"."))}k.isMDXComponent=!0}}]);